这份 README 我导出了 word 方便阅读

# 项目背景

脓毒症可能进展为 SIC，SIC 可能进展为 DIC，建模方向有两个，一个是基于脓毒症患者数据去预测 DIC，另一个是基于 SIC 患者数据预测 DIC，二者代码相同，但是临床意义有所不同，两者都做了，结果分别保存在`机器学习结果（脓毒症）.xlsx`和`机器学习结果（sic）.xlsx`，目前主要做的是后者，数据保存在`data`，前者的数据保存在`data/脓毒症患者`

详见 `02-07 工程师例会.pptx`

# 数据预处理

文件：`data_pre.ipynb`

**数据清洗与缺失值处理**

原始数据集（`data/raw/20250207 null_sic_dic.csv`）包含10441条阴性样本、426条阳性样本，其数据结构特征如下：

-   **非特征字段**：首列为患者ID（`id`）、倒数第二列为现行SIC诊断标准结果（`sic`），均为 1、结局指标（`death`），均不作为模型输入特征

-   **标签定义**：最后一列`dic`为分类标签（0:阴性，1:阳性）

执行分阶段缺失值处理策略：

1.  **特征筛选**：剔除缺失率超过50%的特征变量（本研究中无满足此条件的特征）

2.  **样本筛选**：删除存在5个及以上缺失值的样本（共剔除2944条，保留7923条有效样本）

3.  **缺失值插补**：

    -   *连续性变量*：按标签组别（`dic`分组）计算列均值进行插补

    -   *分类变量*：将缺失值统一编码为"0"，即表示不存在该种情况。\
        清洗后数据保存为`data/清洗后.csv`，其标签分布呈现显著不均衡性（阴性:阳性=7526:397）。

    最后手动把非特征字段删除，把标签（dic）移动到第一列

#### 数据划分与标准化

**分层数据分割**：\
采用分层抽样策略，按8:2比例将数据集划分为训练集（6338条）与测试集（1585条），确保两集合的标签分布与原始数据一致

**特征标准化**：

1.  **Z-score标准化**：对连续型特征进行标准化处理，统一量纲，使得模型能均衡地考虑每个特征。

2.  **步骤**：

    -   基于训练集计算均值与标准差参数

    -   将参数同步应用于测试集标准化，避免数据泄露\
        标准化后数据分别保存为`data/train_data_standardized.csv`与`data/test_data_standardized.csv`。

# 模型

超参数搜索：`grid_search.ipynb`和`grid_search_SMOTENC.ipynb`，后者对训练集进行了过采样（使用 SMOTENC 法）

模型训练：`机器学习实验.ipynb`，这个文件是从 十六支队manifei 项目迁移过来的，但是manifei 项目没有进行过采样，所以代码需要进行修改，目前修改了模型选择部分代码并且成功复现，后面的部分（shap、决策边界等），还没有修改。

# 可视化

特征数值分布热图，代码为 fig-热图.ipynb，结果保存在 fig/特征数值分布热图